# fold-gateway configuration example
# Copy to config.yaml and customize

server:
  # GRPC address for agent connections (not needed if tailscale.enabled)
  grpc_addr: "0.0.0.0:50051"
  # HTTP address for health checks and metrics (not needed if tailscale.enabled)
  http_addr: "0.0.0.0:8080"

# Tailscale integration - run gateway as a node on your tailnet
# When enabled, gateway listens on Tailscale network instead of local TCP
tailscale:
  enabled: false
  # Hostname for this node (e.g., "fold-gateway" -> fold-gateway.tailnet-xxx.ts.net)
  hostname: "fold-gateway"
  # Auth key for automatic registration (or set TS_AUTHKEY env var)
  # Generate at: https://login.tailscale.com/admin/settings/keys
  auth_key: "${TS_AUTHKEY}"
  # State directory (default: ~/.local/share/fold-gateway/tailscale)
  state_dir: ""
  # Ephemeral node - removed from tailnet when gateway stops
  ephemeral: false
  # Enable Funnel to expose HTTP API publicly (requires Funnel enabled in tailnet)
  funnel: false

database:
  # SQLite database path
  path: "./fold-gateway.db"

agents:
  # How often agents should send heartbeats
  heartbeat_interval: "30s"
  # How long to wait before considering agent dead
  heartbeat_timeout: "90s"
  # Grace period for agent reconnection before reassigning work
  reconnect_grace_period: "5m"

frontends:
  slack:
    enabled: false
    # Socket mode app token (xapp-...)
    app_token: "${SLACK_APP_TOKEN}"
    # Bot user OAuth token (xoxb-...)
    bot_token: "${SLACK_BOT_TOKEN}"
    # Only respond in these channels (empty = all)
    allowed_channels: []

  matrix:
    enabled: false
    homeserver: "https://matrix.org"
    user_id: "@yourbot:matrix.org"
    access_token: "${MATRIX_ACCESS_TOKEN}"
    # Only respond to these users (empty = all - dangerous!)
    allowed_users: []
    # Only respond in these rooms (empty = all - dangerous!)
    allowed_rooms: []

logging:
  # Log level: debug, info, warn, error
  level: "info"
  # Log format: json, text
  format: "text"

metrics:
  # Enable Prometheus metrics endpoint
  enabled: true
  # Metrics endpoint path
  path: "/metrics"

webadmin:
  # External URL for admin UI (used for invite links and WebAuthn)
  # If not set, auto-detected from server.http_addr or tailscale.hostname
  # For tsnet with Funnel: https://fold-gateway.your-tailnet.ts.net
  # For tsnet without Funnel: http://fold-gateway (internal tailnet access)
  base_url: ""
