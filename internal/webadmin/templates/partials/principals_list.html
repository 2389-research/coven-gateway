{{/* ABOUTME: HTMX partial for principals table */}}
{{/* ABOUTME: Professional business design */}}
<div class="overflow-x-auto">
    <table class="min-w-full">
        <thead class="bg-warm-50 border-b border-warm-200">
            <tr>
                <th class="px-4 py-3 text-left text-xs font-semibold text-warm-500 uppercase tracking-wider">Name</th>
                <th class="px-4 py-3 text-left text-xs font-semibold text-warm-500 uppercase tracking-wider">Type</th>
                <th class="px-4 py-3 text-left text-xs font-semibold text-warm-500 uppercase tracking-wider">Status</th>
                <th class="px-4 py-3 text-left text-xs font-semibold text-warm-500 uppercase tracking-wider">Last Seen</th>
                <th class="px-4 py-3 text-left text-xs font-semibold text-warm-500 uppercase tracking-wider">Actions</th>
            </tr>
        </thead>
        <tbody class="divide-y divide-warm-100">
            {{if .Principals}}
            {{range .Principals}}
            <tr id="principal-{{.ID}}" class="hover:bg-warm-50 transition-colors">
                <td class="px-4 py-3">
                    <div>
                        <p class="text-sm font-medium text-ink">{{.DisplayName}}</p>
                        <p class="text-xs text-warm-400 font-mono">{{.ID}}</p>
                    </div>
                </td>
                <td class="px-4 py-3">
                    <span class="px-2.5 py-1 text-xs font-medium rounded-full
                        {{if eq .Type "agent"}}bg-forest/10 text-forest
                        {{else if eq .Type "client"}}bg-info/10 text-info
                        {{else}}bg-warm-100 text-warm-500{{end}}">
                        {{.Type}}
                    </span>
                </td>
                <td class="px-4 py-3" id="status-{{.ID}}">
                    <span class="px-2.5 py-1 text-xs font-medium rounded-full
                        {{if eq .Status "approved"}}bg-forest/10 text-forest
                        {{else if eq .Status "pending"}}bg-warning/10 text-warning
                        {{else if eq .Status "revoked"}}bg-danger/10 text-danger
                        {{else}}bg-warm-100 text-warm-500{{end}}">
                        {{.Status}}
                    </span>
                </td>
                <td class="px-4 py-3 text-sm text-warm-500">
                    {{if .LastSeen}}{{.LastSeen.Format "Jan 02 15:04"}}{{else}}--{{end}}
                </td>
                <td class="px-4 py-3">
                    <div class="flex gap-2">
                        {{if eq .Status "pending"}}
                        <button hx-post="/admin/principals/{{.ID}}/approve" hx-target="#status-{{.ID}}" hx-swap="innerHTML"
                            class="px-3 py-1.5 text-xs font-medium bg-forest/10 text-forest rounded-lg hover:bg-forest/20 transition-colors">
                            Approve
                        </button>
                        {{end}}
                        {{if ne .Status "revoked"}}
                        <button hx-post="/admin/principals/{{.ID}}/revoke" hx-target="#status-{{.ID}}" hx-swap="innerHTML"
                            class="px-3 py-1.5 text-xs font-medium bg-danger/10 text-danger rounded-lg hover:bg-danger/20 transition-colors">
                            Revoke
                        </button>
                        {{end}}
                        <button hx-delete="/admin/principals/{{.ID}}" hx-target="#principal-{{.ID}}" hx-swap="outerHTML"
                            hx-confirm="Delete principal {{.DisplayName}}?"
                            class="px-3 py-1.5 text-xs font-medium bg-transparent text-warm-400 border border-warm-200 rounded-lg hover:border-danger hover:text-danger transition-colors">
                            Delete
                        </button>
                    </div>
                </td>
            </tr>
            {{end}}
            {{else}}
            <tr>
                <td colspan="5" class="px-4 py-16 text-center">
                    <div class="flex flex-col items-center text-warm-400">
                        <svg class="w-16 h-16 mb-4 opacity-30" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1" d="M15 7a2 2 0 012 2m4 0a6 6 0 01-7.743 5.743L11 17H9v2H7v2H4a1 1 0 01-1-1v-2.586a1 1 0 01.293-.707l5.964-5.964A6 6 0 1121 9z"/>
                        </svg>
                        <p class="text-sm font-medium">No principals found</p>
                        <p class="text-xs text-warm-300 mt-1">Adjust filters or wait for registrations</p>
                    </div>
                </td>
            </tr>
            {{end}}
        </tbody>
    </table>
</div>
